<html>
	<head>
		<script type="text/javascript">
origin = "";

function changeState(e)
{

	document.getElementById("text").innerHTML = e.value;

	URIText = e.value;
	length = URIText.length-1;

	for(i = 0; i < length; i = i +1)
	{
		if(URIText.charAt(i) == " ")
		{
			URIText = URIText.substr(0,i) + "%20" + URIText.substr(i+1);
			length = length + 2;
		}
	}

	link = origin + "/#" + URIText;
	document.getElementById("textlink").href=link;
	document.getElementById("textlink").style.display="Block";
	window.history.pushState("cat", e.value, link);

	return false;
}

function readURI()
{
	document.getElementById("textlink").style.display="none";
	if(location.href.indexOf("#") != -1)
	{
		displayText = location.href.substr(location.href.indexOf("#")+1);

		length = displayText.length-1;

		for(i = 0; i < length; i = i +1)
		{
			if(displayText.charAt(i) == "%")
			{
				if(displayText.charAt(i+1) == "2")
				{
					if(displayText.charAt(i+2) == "0")
					{
						displayText = displayText.substr(0,i) + " " + displayText.substr(i+3);
						length = length - 2;
					}
				}
			}
		}

		document.getElementById("text").innerHTML = displayText;

		origin = location.href.substr(0,location.href.indexOf("#"));
		if(origin.charAt(origin.length-1) == "/")
			origin = origin.substr(0,origin.length-1);
	}
	else
	{
		origin = location.href;
		if(origin.charAt(origin.length-1) == "/")
			origin = origin.substr(0,origin.length-1);
	}
}

		</script>
	</head>

	<body onload="readURI();">

		<div id="text">test</div>
		</br>
		<a id="textlink" href="">link me</a>

		<form name="newTextForm" onsubmit="return changeState(this.newText);" >
			<input type="text" name="newText" />
			<input type="submit" value="Submit" />
		</form>

	</body>
</head>
